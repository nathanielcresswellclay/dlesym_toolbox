2025-05-30 17:59:08,597 | INFO | Loaded config:

output_log: /pscratch/sd/n/nacc/dlesym_toolbox/analysis_example_outputs/2010_heatwave_anomalies_forced/inference.log
models:
- /pscratch/sd/n/nacc/models/dlesym-ttr_sm
- /pscratch/sd/n/nacc/models/dlesym-ttr
overwrite_forecasts: false

2025-05-30 17:59:28,049 | INFO | Running forecast for model: /pscratch/sd/n/nacc/models/dlesym-ttr_sm
/pscratch/sd/n/nacc/NV-dlesm_ncresswell/inference/forecast_single_component.py:121: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  return pd.Timedelta(hours=dt) if isinstance(dt, int) else pd.Timedelta(dt)
2025-05-30 17:59:30,322 | INFO | opening input datasets
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/datapipes/healpix/couplers.py:80: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  self.input_times = [pd.Timedelta(t) for t in input_times]
**Assuming coupled data has been prepared properly, using coupled field[s] from dataset "as-is"**
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/datapipes/healpix/timeseries_dataset.py:229: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  return pd.Timedelta(hours=dt) if isinstance(dt, int) else pd.Timedelta(dt)
Warning, cannot find healpixpad module
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/models/dlwp_healpix/HEALPixRecUNet.py:135: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  self.delta_t = int(pd.Timedelta(delta_time).total_seconds() // 3600)
2025-05-30 17:59:36,649 | INFO | load model checkpoint /pscratch/sd/n/nacc/models/dlesym-ttr_sm/tensorboard/checkpoints/training-state-epoch-0248-val_loss=1.2784E-03.mdlus
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/models/dlwp_healpix/HEALPixRecUNet.py:135: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  self.delta_t = int(pd.Timedelta(delta_time).total_seconds() // 3600)
2025-05-30 17:59:37,361 | INFO | allocating prediction array. If this fails due to OOM consider reducing lead times or number of forecasts.
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:02<01:07,  2.25s/it, init 2010-06-25 00Z]  6%|▋         | 2/31 [00:11<03:08,  6.51s/it, init 2010-06-25 00Z] 10%|▉         | 3/31 [00:13<02:05,  4.48s/it, init 2010-06-26 00Z] 13%|█▎        | 4/31 [00:21<02:36,  5.79s/it, init 2010-06-27 00Z] 16%|█▌        | 5/31 [00:27<02:30,  5.80s/it, init 2010-06-27 00Z] 19%|█▉        | 6/31 [00:29<01:51,  4.47s/it, init 2010-06-28 00Z] 23%|██▎       | 7/31 [00:37<02:13,  5.58s/it, init 2010-06-29 00Z] 26%|██▌       | 8/31 [00:45<02:26,  6.36s/it, init 2010-06-30 00Z] 29%|██▉       | 9/31 [00:51<02:16,  6.20s/it, init 2010-06-30 00Z] 32%|███▏      | 10/31 [00:53<01:42,  4.90s/it, init 2010-07-01 00Z] 35%|███▌      | 11/31 [01:00<01:55,  5.79s/it, init 2010-07-02 00Z] 39%|███▊      | 12/31 [01:08<02:01,  6.42s/it, init 2010-07-03 00Z] 42%|████▏     | 13/31 [01:16<02:02,  6.81s/it, init 2010-07-04 00Z] 45%|████▌     | 14/31 [01:22<01:50,  6.52s/it, init 2010-07-04 00Z] 48%|████▊     | 15/31 [01:24<01:22,  5.15s/it, init 2010-07-05 00Z] 52%|█████▏    | 16/31 [01:32<01:29,  5.96s/it, init 2010-07-06 00Z] 55%|█████▍    | 17/31 [01:39<01:30,  6.48s/it, init 2010-07-07 00Z] 58%|█████▊    | 18/31 [01:47<01:29,  6.88s/it, init 2010-07-08 00Z] 61%|██████▏   | 19/31 [01:55<01:25,  7.13s/it, init 2010-07-09 00Z] 65%|██████▍   | 20/31 [02:01<01:14,  6.74s/it, init 2010-07-09 00Z] 68%|██████▊   | 21/31 [02:03<00:53,  5.32s/it, init 2010-07-10 00Z] 71%|███████   | 22/31 [02:10<00:54,  6.02s/it, init 2010-07-11 00Z] 74%|███████▍  | 23/31 [02:18<00:52,  6.57s/it, init 2010-07-12 00Z] 77%|███████▋  | 24/31 [02:26<00:48,  6.91s/it, init 2010-07-13 00Z] 81%|████████  | 25/31 [02:34<00:42,  7.14s/it, init 2010-07-14 00Z] 84%|████████▍ | 26/31 [02:41<00:36,  7.34s/it, init 2010-07-15 00Z] 87%|████████▋ | 27/31 [02:47<00:27,  6.88s/it, init 2010-07-15 00Z] 90%|█████████ | 28/31 [02:49<00:16,  5.40s/it, init 2010-07-16 00Z] 94%|█████████▎| 29/31 [02:57<00:12,  6.09s/it, init 2010-07-17 00Z] 97%|█████████▋| 30/31 [03:04<00:06,  6.56s/it, init 2010-07-18 00Z]100%|██████████| 31/31 [03:12<00:00,  6.90s/it, init 2010-07-19 00Z]32it [03:20,  7.17s/it, init 2010-07-20 00Z]                        33it [03:28,  7.33s/it, init 2010-07-21 00Z]34it [03:35,  7.43s/it, init 2010-07-22 00Z]35it [03:41,  6.95s/it, init 2010-07-22 00Z]36it [03:43,  5.42s/it, init 2010-07-23 00Z]37it [03:51,  6.13s/it, init 2010-07-24 00Z]38it [03:59,  6.62s/it, init 2010-07-25 00Z]100%|██████████| 31/31 [04:04<00:00,  7.90s/it, init 2010-07-25 00Z]
/pscratch/sd/n/nacc/NV-dlesm_ncresswell/inference/forecast_single_component.py:109: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  chunk_dict = dict(ds.dims)
2025-05-30 18:03:43,643 | INFO | writing forecasts to /pscratch/sd/n/nacc/models/dlesym-ttr_sm/forecasts/forecast_forced_euro-heatwave2010.nc
[                                        ] | 0% Completed | 226.68 us[########################################] | 100% Completed | 100.61 ms
2025-05-30 18:04:02,644 | INFO | Running forecast for model: /pscratch/sd/n/nacc/models/dlesym-ttr
/pscratch/sd/n/nacc/NV-dlesm_ncresswell/inference/forecast_single_component.py:121: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  return pd.Timedelta(hours=dt) if isinstance(dt, int) else pd.Timedelta(dt)
2025-05-30 18:04:02,775 | INFO | opening input datasets
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/datapipes/healpix/couplers.py:80: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  self.input_times = [pd.Timedelta(t) for t in input_times]
**Assuming coupled data has been prepared properly, using coupled field[s] from dataset "as-is"**
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/datapipes/healpix/timeseries_dataset.py:229: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  return pd.Timedelta(hours=dt) if isinstance(dt, int) else pd.Timedelta(dt)
/pscratch/sd/n/nacc/modulus-uw-dltm/modulus/models/dlwp_healpix/HEALPixRecUNet.py:135: FutureWarning: 'H' is deprecated and will be removed in a future version. Please use 'h' instead of 'H'.
  self.delta_t = int(pd.Timedelta(delta_time).total_seconds() // 3600)
2025-05-30 18:04:04,197 | INFO | load model checkpoint /pscratch/sd/n/nacc/models/dlesym-ttr/tensorboard/checkpoints/training-state-epoch-0247-val_loss=1.2798E-03.mdlus
2025-05-30 18:04:04,306 | INFO | allocating prediction array. If this fails due to OOM consider reducing lead times or number of forecasts.
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:02<01:13,  2.45s/it, init 2010-06-25 00Z]  6%|▋         | 2/31 [00:08<02:08,  4.43s/it, init 2010-06-25 00Z] 10%|▉         | 3/31 [00:10<01:31,  3.28s/it, init 2010-06-26 00Z] 13%|█▎        | 4/31 [00:17<02:15,  5.03s/it, init 2010-06-27 00Z] 16%|█▌        | 5/31 [00:24<02:21,  5.45s/it, init 2010-06-27 00Z] 19%|█▉        | 6/31 [00:25<01:44,  4.18s/it, init 2010-06-28 00Z] 23%|██▎       | 7/31 [00:33<02:07,  5.31s/it, init 2010-06-29 00Z] 26%|██▌       | 8/31 [00:41<02:20,  6.11s/it, init 2010-06-30 00Z] 29%|██▉       | 9/31 [00:47<02:14,  6.13s/it, init 2010-06-30 00Z] 32%|███▏      | 10/31 [00:49<01:40,  4.79s/it, init 2010-07-01 00Z] 35%|███▌      | 11/31 [00:57<01:55,  5.78s/it, init 2010-07-02 00Z] 39%|███▊      | 12/31 [01:04<02:00,  6.34s/it, init 2010-07-03 00Z] 42%|████▏     | 13/31 [01:12<02:01,  6.75s/it, init 2010-07-04 00Z] 45%|████▌     | 14/31 [01:18<01:49,  6.46s/it, init 2010-07-04 00Z] 48%|████▊     | 15/31 [01:20<01:20,  5.03s/it, init 2010-07-05 00Z] 52%|█████▏    | 16/31 [01:27<01:27,  5.83s/it, init 2010-07-06 00Z] 55%|█████▍    | 17/31 [01:35<01:28,  6.33s/it, init 2010-07-07 00Z] 58%|█████▊    | 18/31 [01:42<01:27,  6.73s/it, init 2010-07-08 00Z] 61%|██████▏   | 19/31 [01:50<01:24,  7.07s/it, init 2010-07-09 00Z] 65%|██████▍   | 20/31 [01:56<01:13,  6.70s/it, init 2010-07-09 00Z] 68%|██████▊   | 21/31 [01:58<00:52,  5.27s/it, init 2010-07-10 00Z] 71%|███████   | 22/31 [02:06<00:53,  5.96s/it, init 2010-07-11 00Z] 74%|███████▍  | 23/31 [02:13<00:52,  6.50s/it, init 2010-07-12 00Z] 77%|███████▋  | 24/31 [02:21<00:47,  6.84s/it, init 2010-07-13 00Z] 81%|████████  | 25/31 [02:29<00:42,  7.10s/it, init 2010-07-14 00Z] 84%|████████▍ | 26/31 [02:36<00:36,  7.24s/it, init 2010-07-15 00Z] 87%|████████▋ | 27/31 [02:42<00:27,  6.81s/it, init 2010-07-15 00Z] 90%|█████████ | 28/31 [02:44<00:15,  5.33s/it, init 2010-07-16 00Z] 94%|█████████▎| 29/31 [02:52<00:12,  6.02s/it, init 2010-07-17 00Z] 97%|█████████▋| 30/31 [02:59<00:06,  6.48s/it, init 2010-07-18 00Z]100%|██████████| 31/31 [03:07<00:00,  6.86s/it, init 2010-07-19 00Z]32it [03:15,  7.10s/it, init 2010-07-20 00Z]                        33it [03:22,  7.24s/it, init 2010-07-21 00Z]34it [03:30,  7.38s/it, init 2010-07-22 00Z]35it [03:36,  6.92s/it, init 2010-07-22 00Z]36it [03:37,  5.37s/it, init 2010-07-23 00Z]37it [03:45,  6.07s/it, init 2010-07-24 00Z]38it [03:53,  6.54s/it, init 2010-07-25 00Z]100%|██████████| 31/31 [03:59<00:00,  7.71s/it, init 2010-07-25 00Z]
/pscratch/sd/n/nacc/NV-dlesm_ncresswell/inference/forecast_single_component.py:109: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  chunk_dict = dict(ds.dims)
2025-05-30 18:08:04,871 | INFO | writing forecasts to /pscratch/sd/n/nacc/models/dlesym-ttr/forecasts/forecast_forced_euro-heatwave2010.nc
[                                        ] | 0% Completed | 288.97 us[########################################] | 100% Completed | 100.70 ms
2025-05-30 18:08:23,700 | INFO | All forecasts completed successfully.
